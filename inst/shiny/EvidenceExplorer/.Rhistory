shiny::runApp()
runApp()
shiny::runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
runApp()
shiny::runApp()
shiny::runApp()
runApp()
shiny::runApp()
shiny::runApp()
unique(exposureOfInterest$exposureName)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
blinds
blinds
blinds
runApp()
cohortMethodResult$outcomeID %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisID != 5 | cohortMethodResult$targetID != 13248 | cohortMethodResult$comparatorID != 13247
cohortMethodResult$outcomeID %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisID != 5 | cohortMethodResult$targetID != 13248 | cohortMethodResult$comparatorID != 13247
cohortMethodResult
blinds
blinds
cohortMethodResult$outcomeID %in% c(13186,13245,13320,13323,13326,13326,13327)
cohortMethodResult$outcomeID %in% c(13186,13245,13320,13323,13326,13326,13327)
cohortMethodResult$outcomeID
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327)
cohortMethodResult$databaseId %in% c("CCAE","MDCR")
cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisID != 5 | cohortMethodResult$targetID != 13248 | cohortMethodResult$comparatorID != 13247
cohortMethodResult$databaseId
#primaryTar <- cohortMethodResult$targetId %in% primaryTarCohortIds & cohortMethodResult$comparatorId %in% primaryTarCohortIds & cohortMethodResult$analysisId %in% c(1, 3)
#sensitivityTar <- cohortMethodResult$targetId %in% sensitivityTarCohortIds & cohortMethodResult$comparatorId %in% sensitivityTarCohortIds & cohortMethodResult$analysisId %in% c(1, 3)
#ittTar <- cohortMethodResult$targetId %in% primaryTarCohortIds & cohortMethodResult$comparatorId %in% primaryTarCohortIds & cohortMethodResult$analysisId %in% c(2, 4)
#cohortMethodResult <- cohortMethodResult[primaryTar | sensitivityTar | ittTar, ] # this drops 1:1 SENS ITT amd 1:100 SENS ITT (since the same as 1:1 ITT and 1:100 ITT)
levels(outcomeId)
levels(outcomeId)
levels(cohortMethodResult$outcomeId)
level(cohortMethodResult$outcomeId)
unique(cohortMethodResult$outcomeId)
unique(cohortMethodResult$databaseId)
cohortMethodResult$databaseId %in% c("CCAE","MDCR")
cohortMethodResult$analysisID != 5
cohortMethodResult$analysisID
cohortMethodResult$analysisID
cohortMethodResult$analysisID
cohortMethodResult$analysisID
cohortMethodResult$analysisID
cohortMethodResult$analysisID
cohortMethodResult
unique(cohortMethodResult$analysisId)
cohortMethodResult$analysisId != 5
cohortMethodResult$analysisId != 5
cohortMethodResult$targetID != 13248
cohortMethodResult$targetID != 13248
cohortMethodResult$targetId != 13248
cohortMethodResult$comparatorID != 13247
cohortMethodResult$comparatorID != 13247
runApp()
cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
blinds
#primaryTar <- cohortMethodResult$targetId %in% primaryTarCohortIds & cohortMethodResult$comparatorId %in% primaryTarCohortIds & cohortMethodResult$analysisId %in% c(1, 3)
#sensitivityTar <- cohortMethodResult$targetId %in% sensitivityTarCohortIds & cohortMethodResult$comparatorId %in% sensitivityTarCohortIds & cohortMethodResult$analysisId %in% c(1, 3)
#ittTar <- cohortMethodResult$targetId %in% primaryTarCohortIds & cohortMethodResult$comparatorId %in% primaryTarCohortIds & cohortMethodResult$analysisId %in% c(2, 4)
#cohortMethodResult <- cohortMethodResult[primaryTar | sensitivityTar | ittTar, ] # this drops 1:1 SENS ITT amd 1:100 SENS ITT (since the same as 1:1 ITT and 1:100 ITT)
unique(blinds)
runApp()
blinds
cohortMethodResult$rr
#) & cohortMethodResult$outcomeId == outcomeOfInterest$outcomeId # don't blind negative control estimates
unique(cohortMethodResult$rr)
cohortMethodResult$rr[blinds] <- NA
cohortMethodResult$ci95Ub[blinds] <- NA
cohortMethodResult$ci95Lb[blinds] <- NA
cohortMethodResult$logRr[blinds] <- NA
cohortMethodResult$seLogRr[blinds] <- NA
cohortMethodResult$p[blinds] <- NA
cohortMethodResult$calibratedRr[blinds] <- NA
cohortMethodResult$calibratedCi95Ub[blinds] <- NA
cohortMethodResult$calibratedCi95Lb[blinds] <- NA
cohortMethodResult$calibratedLogRr[blinds] <- NA
cohortMethodResult$calibratedSeLogRr[blinds] <- NA
cohortMethodResult$calibratedP[blinds] <- NA
cohortMethodResult$rr
unique(cohortMethodResult$rr)
cohortMethodResult
cohortMethodResult[cohortMethodResult$analysisId==5,]
unique(cohortMethodResult[cohortMethodResult$analysisId==5,rr])
unique(cohortMethodResult[cohortMethodResult$analysisId==5,rr])
unique(cohortMethodResult[cohortMethodResult$analysisId==5,cohortMethodResult$rr])
cohortMethodResult$rr
cohortMethodResult[cohortMethodResult$analysisId==5,cohortMethodResult$rr]
cohortMethodResult[cohortMethodResult$analysisId==5,cohortMethodResult$rr]
test$cohortMethodResult$rr
test <- unique(cohortMethodResult[cohortMethodResult$analysisId==5,])
test$cohortMethodResult$rr
test$rr
unique(test$rr)
test <- unique(cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResults$rr != NA,])
test <- unique(cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResults$rr != NA,])
test <- unique(cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResult$rr != NA,])
unique(cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResult$rr != NA,])
test <- unique(cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResult$rr = NA,])
unique(cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResult$rr == NA,])
test <- cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResult$rr == NA,]
test
unique(test$rr)
cohortMethodResult[cohortMethodResult$rr != NA)
cohortMethodResult[cohortMethodResult$rr != NA,]
cohortMethodResult[cohortMethodResult$rr != "NA",]
cohortMethodResult$r
cohortMethodResult
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
blinds[cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247,]
cohortMethodResult
blinds
cohortMethodResult[cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247,]
cohortMethodResult[! blinds]
cohortMethodResult[!blinds,]
cohortMethodResult[!blinds,]
nrow(cohortMethodResult[!blinds,])
nrow(cohortMethodResult[blinds,])
cohortMethodResult
unique('targetId','comparatorId','outcomeId','analysisId')
cohortMethodResult[!duplicated(cohortMethodResult[,c('targetId','comparatorId','outcomeId','analysisId')]),]
nrow(cohortMethodResult[!duplicated(cohortMethodResult[,c('targetId','comparatorId','outcomeId','analysisId')]),])
nrow(cohortMethodResult)
nrow(cohortMethodResult)
nrow(cohortMethodResult[!duplicated(cohortMethodResult[,c('targetId','comparatorId','outcomeId','analysisId','databaseId')]),])
cohortMethodResult[cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247,]
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
blinds
nrow(blinds[blinds=TRUE)])
cohortMethodResult[!blinds,]
cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
unique(test$targetId)
(test$tcomparatorId)
unique(test$tcomparatorId)
unique(test$tcomparatorId)
unique(test$comparatorId)
unique(test$outcomeId)
unique(test$analysisId)
unique(test$databaseId)
cohortMethodResult$databaseId %in% c("CCAE","MDCR")
unique(cohortMethodResult$databaseId)
cohortMethodResult[cohortMethodResult$databaseId %in% c("CCAE","MDCR"),]
cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),]
cohortMethodResult$databaseId %in% c("CCAE","MDCR")
cohortMethodResult$databaseId
nrow(cohortMethodResult$databaseId)
nrow(cohortMethodResult)
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("CCAE","MDCR"),]
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("CCAE","MDCR"),]
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("CCAE","MDCR"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum),])
test<- cohortMethodResult[!blinds,]
cohortMethodResult[cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247,]
cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),]
unique(cohortMethodResult$databaseId)
nrow(cohortMethodResult)
nrow(cohortMethodResult[!duplicated(cohortMethodResult[,c('targetId','comparatorId','outcomeId','analysisId','databaseId')]),])
#(
#    (cohortMethodResult$targetId %in% c(11400, 13033) & cohortMethodResult$comparatorId %in% c(11403, 13234) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: rivaroxaban vs NVAF: warfarin
#    (cohortMethodResult$targetId %in% c(11402, 13200) & cohortMethodResult$comparatorId %in% c(11403, 13234) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: dabigatran  vs NVAF: warfarin
#    (cohortMethodResult$targetId %in% c(11400, 13033) & cohortMethodResult$comparatorId %in% c(11402, 13200) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: rivaroxaban vs NVAF: dabigatran
#    (cohortMethodResult$targetId %in% c(11401, 13199) & cohortMethodResult$comparatorId %in% c(11402, 13200) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: apixaban    vs NVAF: dabigatran
#
#    (cohortMethodResult$targetId %in% c(11405, 13204) & cohortMethodResult$comparatorId %in% c(11407, 13235) & cohortMethodResult$databaseId == "MDCR") |                                # VTE: apixaban    vs VTE: warfarin
#    (cohortMethodResult$targetId %in% c(11406, 13205) & cohortMethodResult$comparatorId %in% c(11407, 13235) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # VTE: dabigatran  vs VTE: warfarin
#    (cohortMethodResult$targetId %in% c(11404, 13203) & cohortMethodResult$comparatorId %in% c(11406, 13205) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # VTE: rivaroxaban vs VTE: dabigatran
#    (cohortMethodResult$targetId %in% c(11405, 13204) & cohortMethodResult$comparatorId %in% c(11406, 13205) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # VTE: apixaban    vs VTE: dabigatran
#
#    (cohortMethodResult$targetId %in% c(11412, 13211) & cohortMethodResult$comparatorId %in% c(11415, 13212) & cohortMethodResult$databaseId == "MDCD") |                                # TKR/THR: rivaroxaban vs TKR/THR: warfarin
#    (cohortMethodResult$targetId %in% c(11413, 13212) & cohortMethodResult$comparatorId %in% c(11415, 13237) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR")) |           # TKR/THR: apixaban    vs TKR/THR: warfarin
#    (cohortMethodResult$targetId %in% c(11414, 13213) & cohortMethodResult$comparatorId %in% c(11415, 13237) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # TKR/THR: dabigatran  vs TKR/THR: warfarin
#    (cohortMethodResult$targetId %in% c(11412, 13211) & cohortMethodResult$comparatorId %in% c(11413, 13212) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR")) |           # TKR/THR: rivaroxaban vs TKR/THR: apixaban
#    (cohortMethodResult$targetId %in% c(11412, 13211) & cohortMethodResult$comparatorId %in% c(11414, 13213) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # TKR/THR: rivaroxaban vs TKR/THR: dabigatran
#    (cohortMethodResult$targetId %in% c(11413, 13212) & cohortMethodResult$comparatorId %in% c(11414, 13213) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum"))    # TKR/THR: apixaban    vs TKR/THR: dabigatran
#) & cohortMethodResult$outcomeId == outcomeOfInterest$outcomeId # don't blind negative control estimates
cohortMethodResult$rr[blinds] <- NA
cohortMethodResult$ci95Ub[blinds] <- NA
cohortMethodResult$ci95Lb[blinds] <- NA
cohortMethodResult$logRr[blinds] <- NA
cohortMethodResult$seLogRr[blinds] <- NA
cohortMethodResult$p[blinds] <- NA
cohortMethodResult$calibratedRr[blinds] <- NA
cohortMethodResult$calibratedCi95Ub[blinds] <- NA
cohortMethodResult$calibratedCi95Lb[blinds] <- NA
cohortMethodResult$calibratedLogRr[blinds] <- NA
cohortMethodResult$calibratedSeLogRr[blinds] <- NA
cohortMethodResult$calibratedP[blinds] <- NA
test <- cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResult$rr == NA,]
unique(test$rr)
cohortMethodResult[cohortMethodResult$rr != "NA",]
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),])
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),])
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId == c(MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId == c(MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId == c("MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
unique(cohortMethodResult$databaseId)
blinds
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId == c("MDCR ", "MDCR"") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
test<- cohortMethodResult[!blinds,]
unique(cohortMethodResult$databaseId)
unique(cohortMethodResult$databaseId)
unique(cohortMethodResult$databaseId)
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId == c("MDCR ", "MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
test<- cohortMethodResult[!blinds,]
unique(cohortMethodResult$databaseId)
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
test<- cohortMethodResult[!blinds,]
nrow(cohortMethodResult[cohortMethodResult$databaseId %in% c("Optum),])
test<- cohortMethodResult[!blinds,]
test$databseId=="MDCR"
cohortMethodResult[cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247,]
cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),]
unique(cohortMethodResult$databaseId)
nrow(cohortMethodResult)
nrow(cohortMethodResult[!duplicated(cohortMethodResult[,c('targetId','comparatorId','outcomeId','analysisId','databaseId')]),])
#(
#    (cohortMethodResult$targetId %in% c(11400, 13033) & cohortMethodResult$comparatorId %in% c(11403, 13234) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: rivaroxaban vs NVAF: warfarin
#    (cohortMethodResult$targetId %in% c(11402, 13200) & cohortMethodResult$comparatorId %in% c(11403, 13234) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: dabigatran  vs NVAF: warfarin
#    (cohortMethodResult$targetId %in% c(11400, 13033) & cohortMethodResult$comparatorId %in% c(11402, 13200) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: rivaroxaban vs NVAF: dabigatran
#    (cohortMethodResult$targetId %in% c(11401, 13199) & cohortMethodResult$comparatorId %in% c(11402, 13200) & cohortMethodResult$databaseId == "MDCD") |  # NVAF: apixaban    vs NVAF: dabigatran
#
#    (cohortMethodResult$targetId %in% c(11405, 13204) & cohortMethodResult$comparatorId %in% c(11407, 13235) & cohortMethodResult$databaseId == "MDCR") |                                # VTE: apixaban    vs VTE: warfarin
#    (cohortMethodResult$targetId %in% c(11406, 13205) & cohortMethodResult$comparatorId %in% c(11407, 13235) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # VTE: dabigatran  vs VTE: warfarin
#    (cohortMethodResult$targetId %in% c(11404, 13203) & cohortMethodResult$comparatorId %in% c(11406, 13205) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # VTE: rivaroxaban vs VTE: dabigatran
#    (cohortMethodResult$targetId %in% c(11405, 13204) & cohortMethodResult$comparatorId %in% c(11406, 13205) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # VTE: apixaban    vs VTE: dabigatran
#
#    (cohortMethodResult$targetId %in% c(11412, 13211) & cohortMethodResult$comparatorId %in% c(11415, 13212) & cohortMethodResult$databaseId == "MDCD") |                                # TKR/THR: rivaroxaban vs TKR/THR: warfarin
#    (cohortMethodResult$targetId %in% c(11413, 13212) & cohortMethodResult$comparatorId %in% c(11415, 13237) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR")) |           # TKR/THR: apixaban    vs TKR/THR: warfarin
#    (cohortMethodResult$targetId %in% c(11414, 13213) & cohortMethodResult$comparatorId %in% c(11415, 13237) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # TKR/THR: dabigatran  vs TKR/THR: warfarin
#    (cohortMethodResult$targetId %in% c(11412, 13211) & cohortMethodResult$comparatorId %in% c(11413, 13212) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR")) |           # TKR/THR: rivaroxaban vs TKR/THR: apixaban
#    (cohortMethodResult$targetId %in% c(11412, 13211) & cohortMethodResult$comparatorId %in% c(11414, 13213) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum")) |  # TKR/THR: rivaroxaban vs TKR/THR: dabigatran
#    (cohortMethodResult$targetId %in% c(11413, 13212) & cohortMethodResult$comparatorId %in% c(11414, 13213) & cohortMethodResult$databaseId %in% c("CCAE", "MDCD", "MDCR", "Optum"))    # TKR/THR: apixaban    vs TKR/THR: dabigatran
#) & cohortMethodResult$outcomeId == outcomeOfInterest$outcomeId # don't blind negative control estimates
cohortMethodResult$rr[blinds] <- NA
cohortMethodResult$ci95Ub[blinds] <- NA
cohortMethodResult$ci95Lb[blinds] <- NA
cohortMethodResult$logRr[blinds] <- NA
cohortMethodResult$seLogRr[blinds] <- NA
cohortMethodResult$p[blinds] <- NA
cohortMethodResult$calibratedRr[blinds] <- NA
cohortMethodResult$calibratedCi95Ub[blinds] <- NA
cohortMethodResult$calibratedCi95Lb[blinds] <- NA
cohortMethodResult$calibratedLogRr[blinds] <- NA
cohortMethodResult$calibratedSeLogRr[blinds] <- NA
cohortMethodResult$calibratedP[blinds] <- NA
test <- cohortMethodResult[cohortMethodResult$analysisId==5 & cohortMethodResult$rr == NA,]
unique(test$rr)
cohortMethodResult[cohortMethodResult$rr != "NA",]
test$databseId=="MDCR"
test$databseId=="MDCR"
test$databseId=="MDCR"
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
test<- cohortMethodResult[!blinds,]
test$databseId=="MDCR"
test$databseId=="MDCR"
test$databseId=="MDCR "
unique(test$databseId)
test
unique(test$databseId)
unique(test$databseId)
unique(test$databaseId)
test[test$databaseId=="MDCR"]
test[test$databaseId=="MDCR "]
test[test$databaseId==" MDCR"]
test[test$databaseId=="MDCR"]
test[test$databaseId!="Optum"]
cohortMethodResult[cohortMethodResult$databaseId %in% c("MDCR"),]
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
test
cohortMethodResult$outcomeId
blinds <- (cohortMethodResult$outcomeId %in% c(13186,13245,13320,13323,13326,13326,13327) | cohortMethodResult$databaseId %in% c("CCAE","MDCR") | cohortMethodResult$analysisId != 5 | cohortMethodResult$targetId != 13248 | cohortMethodResult$comparatorId != 13247)
test<- cohortMethodResult[!blinds,]
options(max.print=500)
test
getOption("max.print")
options(max.print=1000)
test<- cohortMethodResult[!blinds,]
test
View(test)
unique(test$databaseId)
unique(test$databaseId)
unique(test$databaseId)
unique(test$databaseId)
unique(test$databaseId)
unique(test$databaseId)
unique(test$databaseId)
blinds
cohortMethodResult[!blinds,]
test<- cohortMethodResult[!blinds,]
cohortMethodResult[cohortMethodResult$outcomeId==13321]
cohortMethodResult[cohortMethodResult$outcomeId==13321]
cohortMethodResult[cohortMethodResult$outcomeId==13321]
cohortMethodResult$outcomeId
cohortMethodResult[cohortMethodResult$outcomeId==13321]
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId==13321
cohortMethodResult[cohortMethodResult$outcomeId==13321]
cohortMethodResult[cohortMethodResult$outcomeId==13321,]
cohortMethodResult
View(cohortMethodResult)
View(cohortMethodResult)
shiny::runApp()
runApp()
View(cohortMethodResult)
runApp()
blinds
test<- cohortMethodResult[!blinds,]
test
View(test)
cohortMethodResult[cohortMethodResult$outcomeId==13321,]
test[test$outcomeId==13321,]
test[test$outcomeId==13321,]
test[test$outcomeId==13321,]
test[test$outcomeId==13325,]
test[test$outcomeId==13324,]
runApp()
blinds
runApp()
cohortMethodResult
View(cohortMethodResult)
cohortMethodResult[cohortMethodResult$outcomeId==13324,]
cohortMethodResult[cohortMethodResult$outcomeId==13324,]
cohortMethodResult[cohortMethodResult$outcomeId==13324 & cohortMethodResult$analysisId=5,]
cohortMethodResult[cohortMethodResult$outcomeId==13324 & cohortMethodResult$analysisId=5,]
cohortMethodResult[cohortMethodResult$outcomeId==13324 & cohortMethodResult$analysisId==5,]
runApp()
runApp()
exposureOfInterest$exposureId
exposureOfInterest$comparatorId
outcomeOfInterest$outcomeId
# This line only selects the AMI, ischemic stroke, and heart failure analyses for the un-stratified cohorts in the OptumDOD database (as-treated analysis using the KEEP-ALL approach and 1:100 variable ratio matching)
keeps <- (cohortMethodResult$databaseId %in% c("Optum") & cohortMethodResult$outcomeId %in% c(13324,13325,13321) & cohortMethodResult$targetId==3186
& cohortMethodResult$comparatorId==13245 & cohortMethodResult$analysisId==5)
# This line only selects the AMI, ischemic stroke, and heart failure analyses for the un-stratified cohorts in the OptumDOD database (as-treated analysis using the KEEP-ALL approach and 1:100 variable ratio matching)
keeps <- (cohortMethodResult$databaseId %in% c("Optum") & cohortMethodResult$outcomeId %in% c(13324,13325,13321) & cohortMethodResult$targetId==3186
& cohortMethodResult$comparatorId==13245 & cohortMethodResult$analysisId==5)
keeps
cohortMethodResult[keeps,]
keeps <- (cohortMethodResult$databaseId %in% c("Optum") & cohortMethodResult$outcomeId %in% c(13324,13325,13321) & cohortMethodResult$targetId==3186
& cohortMethodResult$comparatorId==13245 & cohortMethodResult$analysisId==5)
keeps
cohortMethodResult[keeps,]
cohortMethodResult$targetId
cohortMethodResult$comparatorId
cohortMethodResult$analysisId
cohortMethodResult$targetId
cohortMethodResult$targetId==3186
cohortMethodResults[cohortMethodResult$targetId==3186,]
cohortMethodResult[cohortMethodResult$targetId==3186,]
cohortMethodResult[cohortMethodResult$targetId==3186,]
cohortMethodResult[cohortMethodResult$targetId==3186,]
cohortMethodResult[cohortMethodResult$targetId==3186,]
cohortMethodResult[cohortMethodResult$targetId==3186,]
cohortMethodResult[cohortMethodResult$targetId==3186,]
# This line only selects the AMI, ischemic stroke, and heart failure analyses for the un-stratified cohorts in the OptumDOD database (as-treated analysis using the KEEP-ALL approach and 1:100 variable ratio matching)
keeps <- (cohortMethodResult$databaseId %in% c("Optum") & cohortMethodResult$outcomeId %in% c(13324,13325,13321) & cohortMethodResult$targetId==13186,
& cohortMethodResult$comparatorId==13245 & cohortMethodResult$analysisId==5)
keeps <- (cohortMethodResult$databaseId %in% c("Optum") & cohortMethodResult$outcomeId %in% c(13324,13325,13321) & cohortMethodResult$targetId==13186
& cohortMethodResult$comparatorId==13245 & cohortMethodResult$analysisId==5)
keeps
cohortMethodResult[keeps,]
runApp()
runApp()
runApp()
cohortMethodResult$outcomeId
cohortMethodResult$outcomeId
outcomeOfInterest$outcomeId
cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)
!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327))
cohortMethodResult[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),
UnblindOutcomes <- cohortMethodResult[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
UnblindOutcomes <- cohortMethodResult[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
UnblindOutcomes <- cohortMethodResult[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
UnblindOutcomes <- cohortMethodResult[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
UnblindOutcomes <- cohortMethodResult[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
UnblindOutcomes
cohortMethodResult$outcomeId[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
cohortMethodResult$outcomeId[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
cohortMethodResult$outcomeId[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327)),]
UnblindOutcomes <- cohortMethodResult$outcomeId[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327))]
UnblindOutcomes <- cohortMethodResult$outcomeId[!(cohortMethodResult$outcomeId %in% c(13320,13323,13326,13327))]
UnblindOutcomes
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
km <- readRDS("D:/StudyResults/EPI720_3/shinyDataAll/kaplan_meier_dist_t13186_c13245.rds")
km
View(km)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
source("DataPulls.R")
source("PlotsAndTables.R")
#shinySettings <- list(dataFolder = "D:/jweave17/StudyResults/epi_720/MDCR/shinyData", blind = TRUE)
shinySettings <- list(dataFolder = "D:/StudyResults/EPI720_3/shinyDataAll", blind = FALSE)
dataFolder <- shinySettings$dataFolder
blind <- shinySettings$blind
connection <- NULL
positiveControlOutcome <- NULL
splittableTables <- c("covariate_balance", "preference_score_dist", "kaplan_meier_dist")
files <- list.files(dataFolder, pattern = ".rds")
# Find part to remove from all file names (usually databaseId):
databaseFileName <- files[grepl("^database", files)]
removePart <- paste0(gsub("database", "", databaseFileName), "$")
# Remove data already in global environment:
tableNames <- gsub("_t[0-9]+_c[0-9]+$", "", gsub(removePart, "", files))
camelCaseNames <- SqlRender::snakeCaseToCamelCase(tableNames)
camelCaseNames <- unique(camelCaseNames)
camelCaseNames <- camelCaseNames[!(camelCaseNames %in% SqlRender::snakeCaseToCamelCase(splittableTables))]
suppressWarnings(
rm(list = camelCaseNames)
)
# Load data from data folder. R data objects will get names derived from the filename:
loadFile <- function(file) {
tableName <- gsub("_t[0-9]+_c[0-9]+$", "", gsub(removePart, "", file))
camelCaseName <- SqlRender::snakeCaseToCamelCase(tableName)
if (!(tableName %in% splittableTables)) {
newData <- readRDS(file.path(dataFolder, file))
colnames(newData) <- SqlRender::snakeCaseToCamelCase(colnames(newData))
if (exists(camelCaseName, envir = .GlobalEnv)) {
existingData <- get(camelCaseName, envir = .GlobalEnv)
newData <- rbind(existingData, newData)
}
assign(camelCaseName, newData, envir = .GlobalEnv)
}
invisible(NULL)
}
lapply(files, loadFile)
tcos <- unique(cohortMethodResult[, c("targetId", "comparatorId", "outcomeId")])
tcos <- tcos[tcos$outcomeId %in% outcomeOfInterest$outcomeId, ]
source("DataClean.R")
View(covariate)
covariate[covariate$covariateId==4044013210,]
covariate[covariate$covariateId==4044013210 & covariate$databaseId == "Optum",]
bal <- readRDS("D:/StudyResults/EPI720_3/Optum/AsTreated/balance/bal_t13186_c13245_o13320_a5.rds")
View(bal)
bal[bal$covariateId == 4044013210]
bal[bal$covariateId == 4044013210,]
